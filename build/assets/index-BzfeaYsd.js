import{Q as P,B as R,r as C,j as e,a as M,K as E}from"./index-C607L3NO.js";import{A as B}from"./AdaptiveCard-DGDz7xR4.js";import{A as T,T as w}from"./index-Dw6USHNV.js";import{T as q}from"./Tag-BbGzO40G.js";import{D as K,C as Q,S as V}from"./StickyFooter-RNYNVyGO.js";import{a as $}from"./CustomersService-ht75Gneg.js";import{u as G}from"./index-XbpPjDmP.js";import{c as D}from"./cloneDeep-SyEe5GSS.js";import{v as U,w as W,x as _,y as H,z as J,A as X,B as Y}from"./toString-Bwyjzsoc.js";import{B as h}from"./Button-BGNlWC2q.js";import{D as Z,R as ee}from"./RichTextEditor-CVMaEZT0.js";import{D as F}from"./Dialog-B2uIaC1M.js";import{C as k}from"./index-Bx-NXTjJ.js";import{z as y,u as te,t as se,F as ae,a as L,C as A,I as re}from"./index-BsyKxmTm.js";import{t as oe,N as ne}from"./toast-CDPb8hdy.js";import{C as le}from"./ConfirmDialog-DSnV0zd4.js";import"./Card-1HCxGsWA.js";import"./useMergeRef-DOQ7ycPl.js";import"./index-C0Bidem1.js";import"./CloseButton-BXcBQvwe.js";import"./classNames-BXHP0mo8.js";import"./index-xBh2-DTE.js";import"./Skeleton-CPq9P_U5.js";import"./useControllableState-Z-3G6vqG.js";import"./Select-BFKD9t5_.js";import"./index-BJphkZ0V.js";import"./index-Bx_zRB3i.js";import"./_getPrototype-DgXCYaqH.js";import"./index-Dyj4Yi5E.js";import"./index-DyvKvQJa.js";import"./isNil-C1sdKuru.js";import"./useUncertainRef-Cr4JDrTD.js";import"./useUniqueId-Dupj_QGJ.js";import"./uniqueId-h1-Q-Q6x.js";import"./index-DXXL45do.js";import"./index-DQXJF41S.js";import"./useTimeout-5mLzQ-yb.js";import"./StatusIcon-CIHdvxDX.js";const ie={pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ce={purchasedProducts:"",purchaseChannel:["Retail Stores","Online Retailers","Resellers","Mobile Apps","Direct Sales"]},me={tableData:ie,filterData:ce,selectedCustomer:[]},de=P(t=>({...me,setFilterData:s=>t(()=>({filterData:s})),setTableData:s=>t(()=>({tableData:s})),setSelectedCustomer:(s,l)=>t(r=>{const n=r.selectedCustomer;return s?{selectedCustomer:[...n,l]}:n.some(m=>l.id===m.id)?{selectedCustomer:n.filter(m=>m.id!==l.id)}:{selectedCustomer:n}}),setSelectAllCustomer:s=>t(()=>({selectedCustomer:s}))}));function S(){const{tableData:t,filterData:s,setTableData:l,selectedCustomer:r,setSelectedCustomer:n,setSelectAllCustomer:m,setFilterData:u}=de(j=>j),{data:d,error:i,isLoading:g,mutate:c}=G(["/api/customers",{...t,...s}],([j,b])=>$(b),{revalidateOnFocus:!1}),p=(d==null?void 0:d.list)||[],x=(d==null?void 0:d.total)||0;return{customerList:p,customerListTotal:x,error:i,isLoading:g,tableData:t,filterData:s,mutate:c,setTableData:l,selectedCustomer:r,setSelectedCustomer:n,setSelectAllCustomer:m,setFilterData:u}}const ue={active:"bg-emerald-200 dark:bg-emerald-200 text-gray-900 dark:text-gray-900",blocked:"bg-red-200 dark:bg-red-200 text-gray-900 dark:text-gray-900"},xe=({row:t})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{size:40,shape:"circle",src:t.img}),e.jsx(M,{className:"hover:text-primary ml-2 rtl:mr-2 font-semibold text-gray-900 dark:text-gray-100",to:`/concepts/customers/customer-details/${t.id}`,children:t.name})]}),pe=({onEdit:t,onViewDetail:s})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{title:"Edit",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:t,children:e.jsx(U,{})})}),e.jsx(w,{title:"View",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:s,children:e.jsx(W,{})})})]}),he=()=>{const t=R(),{customerList:s,customerListTotal:l,tableData:r,isLoading:n,setTableData:m,setSelectAllCustomer:u,setSelectedCustomer:d,selectedCustomer:i}=S(),g=a=>{t(`/concepts/customers/customer-edit/${a.id}`)},c=a=>{t(`/concepts/customers/customer-details/${a.id}`)},p=C.useMemo(()=>[{header:"Name",accessorKey:"name",cell:a=>{const o=a.row.original;return e.jsx(xe,{row:o})}},{header:"Email",accessorKey:"email"},{header:"location",accessorKey:"personalInfo.location"},{header:"Status",accessorKey:"status",cell:a=>{const o=a.row.original;return e.jsx("div",{className:"flex items-center",children:e.jsx(q,{className:ue[o.status],children:e.jsx("span",{className:"capitalize",children:o.status})})})}},{header:"Spent",accessorKey:"totalSpending",cell:a=>e.jsxs("span",{children:["$",a.row.original.totalSpending]})},{header:"",id:"action",cell:a=>e.jsx(pe,{onEdit:()=>g(a.row.original),onViewDetail:()=>c(a.row.original)})}],[]),x=a=>{m(a),i.length>0&&u([])},j=a=>{const o=D(r);o.pageIndex=a,x(o)},b=a=>{const o=D(r);o.pageSize=Number(a),o.pageIndex=1,x(o)},f=a=>{const o=D(r);o.sort=a,x(o)},v=(a,o)=>{d(a,o)},N=(a,o)=>{if(a){const z=o.map(O=>O.original);u(z)}else u([])};return e.jsx(K,{selectable:!0,columns:p,data:s,noData:!n&&s.length===0,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:n,pagingData:{total:l,pageIndex:r.pageIndex,pageSize:r.pageSize},checkboxChecked:a=>i.some(o=>o.id===a.id),onPaginationChange:j,onSelectChange:b,onSort:f,onCheckBoxChange:v,onIndeterminateCheckBoxChange:N})},ge=()=>{const t=R(),{customerList:s}=S();return e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx(Q,{className:"w-full",filename:"customerList.csv",data:s,children:e.jsx(h,{icon:e.jsx(_,{className:"text-xl"}),className:"w-full",children:"Download"})}),e.jsx(h,{variant:"solid",icon:e.jsx(H,{className:"text-xl"}),onClick:()=>t("/Criar-quiro"),children:"Add novo"})]})},I=C.forwardRef((t,s)=>{const{onInputChange:l}=t;return e.jsx(Z,{ref:s,placeholder:"Buscar Quiropraxista...",suffix:e.jsx(J,{className:"text-lg"}),onChange:r=>l(r.target.value)})});I.displayName="CustomerListSearch";const fe=["Retail Stores","Online Retailers","Resellers","Mobile Apps","Direct Sales"],je=y.object({purchasedProducts:y.string(),purchaseChannel:y.array(y.string())}),Ce=()=>{const[t,s]=C.useState(!1),{filterData:l,setFilterData:r}=S(),n=()=>{s(!0)},m=()=>{s(!1)},{handleSubmit:u,reset:d,control:i}=te({defaultValues:l,resolver:se(je)}),g=c=>{r(c),s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(h,{icon:e.jsx(X,{}),onClick:()=>n(),children:"Filter"}),e.jsxs(F,{isOpen:t,onClose:m,onRequestClose:m,children:[e.jsx("h4",{className:"mb-4",children:"Filter"}),e.jsxs(ae,{onSubmit:u(g),children:[e.jsx(L,{label:"Products",children:e.jsx(A,{name:"purchasedProducts",control:i,render:({field:c})=>e.jsx(re,{type:"text",autoComplete:"off",placeholder:"Search by purchased product",...c})})}),e.jsx(L,{label:"Purchase Channel",children:e.jsx(A,{name:"purchaseChannel",control:i,render:({field:c})=>e.jsx(k.Group,{vertical:!0,className:"flex mt-4",...c,children:fe.map((p,x)=>e.jsx(k,{name:c.name,value:p,className:"justify-between flex-row-reverse heading-text",children:p},p+x))})})}),e.jsxs("div",{className:"flex justify-end items-center gap-2 mt-4",children:[e.jsx(h,{type:"button",onClick:()=>d(),children:"Reset"}),e.jsx(h,{type:"submit",variant:"solid",children:"Apply"})]})]})]})]})},be=()=>{const{tableData:t,setTableData:s}=S(),l=r=>{const n=D(t);n.query=r,n.pageIndex=1,typeof r=="string"&&r.length>1&&s(n),typeof r=="string"&&r.length===0&&s(n)};return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx(I,{onInputChange:l}),e.jsx(Ce,{})]})},Se=()=>{const{selectedCustomer:t,customerList:s,mutate:l,customerListTotal:r,setSelectAllCustomer:n}=S(),[m,u]=C.useState(!1),[d,i]=C.useState(!1),[g,c]=C.useState(!1),p=()=>{u(!0)},x=()=>{u(!1)},j=()=>{const f=s.filter(v=>!t.some(N=>N.id===v.id));n([]),l({list:f,total:r-t.length},!1),u(!1)},b=()=>{c(!0),setTimeout(()=>{oe.push(e.jsx(ne,{type:"success",children:"Message sent!"}),{placement:"top-center"}),c(!1),i(!1),n([])},500)};return e.jsxs(e.Fragment,{children:[t.length>0&&e.jsx(V,{className:" flex items-center justify-between py-4 bg-white dark:bg-gray-800",stickyClass:"-mx-4 sm:-mx-8 border-t border-gray-200 dark:border-gray-700 px-8",defaultClass:"container mx-auto px-8 rounded-xl border border-gray-200 dark:border-gray-600 mt-4",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:t.length>0&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg text-primary",children:e.jsx(Y,{})}),e.jsxs("span",{className:"font-semibold flex items-center gap-1",children:[e.jsxs("span",{className:"heading-text",children:[t.length," ","Quiropraxistas"]}),e.jsx("span",{children:"Selecionar"})]})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(h,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error",onClick:p,children:"Deletar"}),e.jsx(h,{size:"sm",variant:"solid",onClick:()=>i(!0),children:"Menssagem"})]})]})})}),e.jsx(le,{isOpen:m,type:"danger",title:"Remove customers",onClose:x,onRequestClose:x,onCancel:x,onConfirm:j,children:e.jsxs("p",{children:[" ","Are you sure you want to remove these customers? This action can't be undo."," "]})}),e.jsxs(F,{isOpen:d,onRequestClose:()=>i(!1),onClose:()=>i(!1),children:[e.jsx("h5",{className:"mb-2",children:"Send Message"}),e.jsx("p",{children:"Send message to the following customers"}),e.jsx(T.Group,{chained:!0,omittedAvatarTooltip:!0,className:"mt-4",maxCount:4,omittedAvatarProps:{size:30},children:t.map(f=>e.jsx(w,{title:f.name,children:e.jsx(T,{size:30,src:f.img,alt:""})},f.id))}),e.jsx("div",{className:"my-4",children:e.jsx(ee,{content:""})}),e.jsxs("div",{className:"ltr:justify-end flex items-center gap-2",children:[e.jsx(h,{size:"sm",onClick:()=>i(!1),children:"Cancel"}),e.jsx(h,{size:"sm",variant:"solid",loading:g,onClick:b,children:"Send"})]})]})]})},nt=()=>e.jsxs(e.Fragment,{children:[e.jsx(E,{children:e.jsx(B,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Quiropraxista"}),e.jsx(ge,{})]}),e.jsx(be,{}),e.jsx(he,{})]})})}),e.jsx(Se,{})]});export{nt as default};
