import{j as e,M as j,B as w,r as S,d as T}from"./index-C607L3NO.js";import{B as c}from"./Button-BGNlWC2q.js";import{T as m}from"./Tag-BbGzO40G.js";import{A as M}from"./index-Dw6USHNV.js";import{t as p,N as x}from"./toast-CDPb8hdy.js";import{C as D}from"./CreditCardDialog-BBxcyqUh.js";import{T as f}from"./index-xBh2-DTE.js";import{B as P}from"./Badge-BxvBSlDX.js";import{c as E,u as B,f as u,g as A}from"./index-BJphkZ0V.js";import{N as y}from"./react-number-format.es-DctIRRPE.js";import{c as I}from"./AccontsService-Buei5PPp.js";import{i as R}from"./isLastChild-BgvHfb_g.js";import{s as h}from"./sleep-BvINh1mj.js";import{U as O}from"./toString-Bwyjzsoc.js";import{u as Y}from"./index-XbpPjDmP.js";import{aF as H}from"./index-DQXJF41S.js";import"./classNames-BXHP0mo8.js";import"./useMergeRef-DOQ7ycPl.js";import"./index-C0Bidem1.js";import"./CloseButton-BXcBQvwe.js";import"./useTimeout-5mLzQ-yb.js";import"./StatusIcon-CIHdvxDX.js";import"./index-BsyKxmTm.js";import"./isNil-C1sdKuru.js";import"./Dialog-B2uIaC1M.js";import"./index-Bx_zRB3i.js";const{Tr:g,Th:F,Td:k,THead:z,TBody:W}=f,J={paid:"bg-emerald-500",pending:"bg-amber-400"},l=E(),V=[l.accessor("id",{header:"Reference",cell:r=>{const s=r.row.original;return e.jsx("span",{className:"heading-text font-bold cursor-pointer",children:s.id})}}),l.accessor("item",{header:"Product",cell:r=>{const s=r.row.original;return e.jsx("span",{className:"font-semibold",children:s.item})}}),l.accessor("status",{header:"Status",cell:r=>{const s=r.row.original;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:J[s.status]}),e.jsx("span",{className:"heading-text font-bold  capitalize",children:s.status})]})}}),l.accessor("date",{header:"Date",cell:r=>{const s=r.row.original;return e.jsx("div",{className:"flex items-center",children:j.unix(s.date).format("MM/DD/YYYY")})}}),l.accessor("amount",{header:"Amount",cell:r=>{const s=r.row.original;return e.jsx("div",{className:"flex items-center",children:e.jsx(y,{displayType:"text",value:(Math.round(s.amount*100)/100).toFixed(2),prefix:"$",thousandSeparator:!0})})}})],L=({data:r=[],...s})=>{const n=B({data:r,columns:V,getCoreRowModel:A()});return e.jsx("div",{...s,children:e.jsxs(f,{children:[e.jsx(z,{className:"!bg-transparent",children:n.getHeaderGroups().map(t=>e.jsx(g,{children:t.headers.map(i=>e.jsx(F,{colSpan:i.colSpan,children:u(i.column.columnDef.header,i.getContext())},i.id))},t.id))}),e.jsx(W,{children:n.getRowModel().rows.map(t=>e.jsx(g,{children:t.getVisibleCells().map(i=>e.jsx(k,{children:u(i.column.columnDef.cell,i.getContext())},i.id))},t.id))})]})})},$=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fe=()=>{var d;const r=w(),[s,n]=S.useState({type:"",dialogOpen:!1,cardInfo:{}}),{data:t={currentPlan:{plan:"",status:"",billingCycle:"",nextPaymentDate:null,amount:null},paymentMethods:[],transactionHistory:[]}}=Y("/api/settings/billing/",()=>I(),{revalidateOnFocus:!1,revalidateIfStale:!1,revalidateOnReconnect:!1}),i=a=>{n({type:"EDIT",dialogOpen:!0,cardInfo:a})},o=()=>{n({type:"",dialogOpen:!1,cardInfo:{}})},N=async()=>{await h(500),o(),p.push(e.jsx(x,{type:"success",children:"Credit card updated!"}),{placement:"top-center"})},b=async a=>{console.log("Submitted values",a),await h(500),o(),p.push(e.jsx(x,{type:"success",children:"Credit card added!"}),{placement:"top-center"})},v=()=>{r("/concepts/account/pricing?subcription=basic&cycle=monthly")};return e.jsxs("div",{children:[e.jsx("h4",{className:"mb-4",children:"Billing"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-xl p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{children:e.jsx(M,{className:"bg-emerald-500",shape:"circle",icon:e.jsx(H,{})})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h6",{className:"font-bold",children:t.currentPlan.plan}),e.jsx(m,{className:"bg-success-subtle text-success rounded-md border-0",children:e.jsx("span",{className:"capitalize",children:t.currentPlan.status})})]}),e.jsxs("div",{className:"font-semibold",children:[e.jsxs("span",{children:["Billing ",t.currentPlan.billingCycle]}),e.jsx("span",{children:" | "}),e.jsxs("span",{children:["Next payment on"," ",j.unix(t.currentPlan.nextPaymentDate||0).format("MM/DD/YYYY")]}),e.jsxs("span",{children:[e.jsx("span",{className:"mx-1",children:"for"}),e.jsx(y,{className:"font-bold heading-text",displayType:"text",value:(Math.round((t.currentPlan.amount||0)*100)/100).toFixed(2),prefix:"$",thousandSeparator:!0})]})]})]})]}),e.jsx("div",{className:"flex",children:e.jsx(c,{size:"sm",variant:"solid",onClick:v,children:"Change plan"})})]})}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h5",{children:"Payment method"}),e.jsxs("div",{children:[(d=t.paymentMethods)==null?void 0:d.map((a,C)=>e.jsxs("div",{className:T("flex items-center justify-between p-4",!R(t.paymentMethods,C)&&"border-b border-gray-200 dark:border-gray-600"),children:[e.jsxs("div",{className:"flex items-center",children:[a.cardType==="VISA"&&e.jsx("img",{src:"/img/others/img-8.png",alt:"visa"}),a.cardType==="MASTER"&&e.jsx("img",{src:"/img/others/img-9.png",alt:"master"}),e.jsxs("div",{className:"ml-3 rtl:mr-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"text-gray-900 dark:text-gray-100 font-semibold",children:[a.cardHolderName," ••••"," ",a.last4Number]}),a.primary&&e.jsx(m,{className:"bg-primary-subtle text-primary rounded-md border-0 mx-2",children:e.jsxs("span",{className:"capitalize",children:[" ","Primary"," "]})})]}),e.jsxs("span",{children:["Expired"," ",$[parseInt(a.expMonth)-1]," 20",a.expYear]})]})]}),e.jsx("div",{className:"flex",children:e.jsx(c,{size:"sm",type:"button",onClick:()=>i(a),children:"Edit"})})]},a.cardId)),e.jsx(c,{variant:"plain",icon:e.jsx(O,{}),onClick:()=>{n({type:"NEW",dialogOpen:!0,cardInfo:{}})},children:"Add payment method"})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h5",{children:"Transaction history"}),e.jsx(L,{className:"mt-4",data:t.transactionHistory})]}),e.jsx(D,{title:s.type==="NEW"?"Add credit card":"Edit credit card",defaultValues:s.cardInfo,dialogOpen:s.dialogOpen,onDialogClose:o,onSubmit:s.type==="NEW"?a=>b(a):N})]})};export{fe as default};
