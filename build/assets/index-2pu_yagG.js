import{X as U,Q as X,B as I,j as e,r as j,d as O,T as _,K as H}from"./index-C607L3NO.js";import{A as J}from"./AdaptiveCard-DGDz7xR4.js";import{B as b}from"./Button-BGNlWC2q.js";import{x as Y,U as Z,z as ee,A as te,O as se,v as ae,u as re,B as ne}from"./toString-Bwyjzsoc.js";import{u as oe}from"./index-XbpPjDmP.js";import{C as le,u as ce,D as ie,S as de}from"./StickyFooter-RNYNVyGO.js";import{I as ue,z as p,u as me,t as xe,F as pe,a as T,C as S}from"./index-BsyKxmTm.js";import{D as he}from"./Drawer-BmNDlxuy.js";import{C as w}from"./index-Bx-NXTjJ.js";import{B}from"./Badge-BxvBSlDX.js";import{S as ge,O as fe,c as je}from"./Select-BFKD9t5_.js";import{N as A}from"./NumericInput-B59N_2AO.js";import{c as y}from"./cloneDeep-SyEe5GSS.js";import{A as be,T as k}from"./index-Dw6USHNV.js";import{P as Ce}from"./Progress-ClvhNQQE.js";import{C as R}from"./ConfirmDialog-DSnV0zd4.js";import{N as L}from"./react-number-format.es-DctIRRPE.js";import"./Card-1HCxGsWA.js";import"./classNames-BXHP0mo8.js";import"./index-xBh2-DTE.js";import"./Skeleton-CPq9P_U5.js";import"./CloseButton-BXcBQvwe.js";import"./useControllableState-Z-3G6vqG.js";import"./index-BJphkZ0V.js";import"./index-Bx_zRB3i.js";import"./isNil-C1sdKuru.js";import"./index-C0Bidem1.js";import"./useMergeRef-DOQ7ycPl.js";import"./_getPrototype-DgXCYaqH.js";import"./Dialog-B2uIaC1M.js";async function ve(t){return U.fetchDataWithAxios({url:"/products",method:"get",params:t})}const Se={pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ye={minAmount:0,maxAmount:5e3,productStatus:"published",productType:["Bags","Cloths","Devices","Shoes","Watches"]},De={tableData:Se,filterData:ye,selectedProduct:[]},Ne=X(t=>({...De,setFilterData:s=>t(()=>({filterData:s})),setTableData:s=>t(()=>({tableData:s})),setSelectedProduct:(s,n)=>t(d=>{const c=d.selectedProduct;return s?{selectedProduct:[...c,n]}:c.some(i=>n.id===i.id)?{selectedProduct:c.filter(i=>i.id!==n.id)}:{selectedProduct:c}}),setSelectAllProduct:s=>t(()=>({selectedProduct:s}))})),C=()=>{const{tableData:t,filterData:s,setTableData:n,setFilterData:d,selectedProduct:c,setSelectedProduct:i,setSelectAllProduct:u}=Ne(v=>v),{data:m,error:o,isLoading:l,mutate:x}=oe(["/api/products",{...t,...s}],([v,f])=>ve(f),{revalidateOnFocus:!1}),h=(m==null?void 0:m.list)||[],g=(m==null?void 0:m.total)||0;return{error:o,isLoading:l,tableData:t,filterData:s,mutate:x,productList:h,productListTotal:g,setTableData:n,selectedProduct:c,setSelectedProduct:i,setSelectAllProduct:u,setFilterData:d}},Pe=()=>{const t=I(),{productList:s}=C();return e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx(le,{filename:"product-list.csv",data:s,children:e.jsx(b,{icon:e.jsx(Y,{className:"text-xl"}),children:"Exportar"})}),e.jsx(b,{variant:"solid",icon:e.jsx(Z,{className:"text-xl"}),onClick:()=>t("/concepts/customers/customer-create"),children:"Add planos"})]})},z=j.forwardRef((t,s)=>{const{onInputChange:n}=t;function d(u){n==null||n(u)}const c=ce(d,500),i=u=>{c(u.target.value)};return e.jsx(ue,{ref:s,placeholder:"Buscar",suffix:e.jsx(ee,{className:"text-lg"}),onChange:i})});z.displayName="ProductListSearch";const{Control:Te}=je,F=[{value:"published",label:"Published",className:"bg-emerald-500"},{value:"inactive",label:"Inactive",className:"bg-red-500"},{value:"scheduled",label:"Scheduled",className:"bg-amber-500"},{value:"draft",label:"Draft",className:"bg-gray-400"}],we=["Bags","Cloths","Devices","Shoes","Watches"],Ae=t=>e.jsx(fe,{...t,customLabel:(s,n)=>e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(B,{className:s.className}),e.jsx("span",{className:"ml-2 rtl:mr-2",children:n})]})}),ke=({children:t,...s})=>{const n=s.getValue()[0];return e.jsxs(Te,{...s,children:[n&&e.jsx(B,{className:O("ml-4",n.className)}),t]})},Le=p.object({minAmount:p.union([p.string(),p.number()]),maxAmount:p.union([p.string(),p.number()]),productStatus:p.string(),productType:p.array(p.string())}),Fe=()=>{const[t,s]=j.useState(!1),{filterData:n,setFilterData:d}=C(),{handleSubmit:c,control:i,getValues:u}=me({defaultValues:n,resolver:xe(Le)}),m=o=>{d(o),s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(b,{icon:e.jsx(te,{}),onClick:()=>s(!0),children:"Filtro"}),e.jsx(he,{title:"Filter",isOpen:t,onClose:()=>s(!1),onRequestClose:()=>s(!1),children:e.jsxs(pe,{className:"h-full",containerClassName:"flex flex-col justify-between h-full",onSubmit:c(m),children:[e.jsxs("div",{children:[e.jsx(T,{label:"Product price",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{name:"minAmount",control:i,render:({field:o})=>e.jsx(A,{thousandSeparator:!0,type:"text",inputPrefix:"$",autoComplete:"off",placeholder:"0.00",value:o.value,max:u("maxAmount"),isAllowed:l=>{const{floatValue:x}=l;return(x||0)<=u("maxAmount")},onChange:l=>o.onChange(l.target.value)})}),e.jsx("span",{children:e.jsx(se,{})}),e.jsx(S,{name:"maxAmount",control:i,render:({field:o})=>e.jsx(A,{thousandSeparator:!0,type:"text",inputPrefix:"$",autoComplete:"off",placeholder:"0.00",value:o.value,onChange:o.onChange})})]})}),e.jsx(T,{label:"Product status",children:e.jsx(S,{name:"productStatus",control:i,render:({field:o})=>e.jsx(ge,{options:F,...o,value:F.filter(l=>l.value===o.value),components:{Option:Ae,Control:ke},onChange:l=>o.onChange(l==null?void 0:l.value)})})}),e.jsx(T,{label:"Product type",children:e.jsx("div",{className:"mt-4",children:e.jsx(S,{name:"productType",control:i,render:({field:o})=>e.jsx(w.Group,{vertical:!0,className:"flex",...o,children:we.map((l,x)=>e.jsx(w,{name:o.name,value:l,className:"justify-between flex-row-reverse heading-text",children:l},l+x))})})})})]}),e.jsx(b,{variant:"solid",type:"submit",children:"Query"})]})})]})},Ie=()=>{const{tableData:t,setTableData:s}=C(),n=d=>{const c=y(t);c.query=d,c.pageIndex=1,typeof d=="string"&&d.length>1&&s(c),typeof d=="string"&&d.length===0&&s(c)};return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx(z,{onInputChange:n}),e.jsx(Fe,{})]})};function Oe(t){return _({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"16.5",y1:"9.4",x2:"7.5",y2:"4.21"},child:[]},{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"},child:[]},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"},child:[]},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"},child:[]}]})(t)}const Be=({row:t})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{shape:"round",size:60,...t.img?{src:t.img}:{icon:e.jsx(Oe,{})}}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold heading-text mb-1",children:t.name}),e.jsxs("span",{children:["ID: ",t.productCode]})]})]}),Re=({onEdit:t,onDelete:s})=>e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx(k,{title:"Edit",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:t,children:e.jsx(ae,{})})}),e.jsx(k,{title:"Delete",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:s,children:e.jsx(re,{})})})]}),ze=()=>{const t=I(),[s,n]=j.useState(!1),[d,c]=j.useState(""),i=()=>{n(!1)},u=a=>{n(!0),c(a.id)},m=a=>{t(`/concepts/products/product-edit/${a.id}`)},o=()=>{const a=l.filter(r=>d!==r.id);f([]),V({list:a,total:x-D.length},!1),n(!1),c("")},{productList:l,productListTotal:x,tableData:h,isLoading:g,setTableData:v,setSelectAllProduct:f,setSelectedProduct:E,selectedProduct:D,mutate:V}=C(),q=j.useMemo(()=>[{header:"Product",accessorKey:"name",cell:a=>{const r=a.row.original;return e.jsx(Be,{row:r})}},{header:"Price",accessorKey:"price",cell:a=>{const{price:r}=a.row.original;return e.jsx("span",{className:"font-bold heading-text",children:e.jsx(L,{fixedDecimalScale:!0,prefix:"$",displayType:"text",value:r,decimalScale:2,thousandSeparator:!0})})}},{header:"Quantity",accessorKey:"stock",cell:a=>{const r=a.row.original;return e.jsx("span",{className:"font-bold heading-text",children:r.stock})}},{header:"Sales",accessorKey:"status",cell:a=>{const{salesPercentage:r,sales:P}=a.row.original;return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("span",{className:"flex gap-1",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(L,{displayType:"text",value:P,thousandSeparator:!0})}),e.jsx("span",{children:"Sales"})]}),e.jsx(Ce,{percent:r,showInfo:!1,customColorClass:O("bg-error",r>40&&"bg-warning",r>70&&"bg-success")})]})}},{header:"",id:"action",cell:a=>e.jsx(Re,{onEdit:()=>m(a.row.original),onDelete:()=>u(a.row.original)})}],[]),N=a=>{v(a),D.length>0&&f([])},K=a=>{const r=y(h);r.pageIndex=a,N(r)},W=a=>{const r=y(h);r.pageSize=Number(a),r.pageIndex=1,N(r)},$=a=>{const r=y(h);r.sort=a,N(r)},G=(a,r)=>{E(a,r)},M=(a,r)=>{if(a){const P=r.map(Q=>Q.original);f(P)}else f([])};return e.jsxs(e.Fragment,{children:[e.jsx(ie,{selectable:!0,columns:q,data:l,noData:!g&&l.length===0,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:g,pagingData:{total:x,pageIndex:h.pageIndex,pageSize:h.pageSize},checkboxChecked:a=>D.some(r=>r.id===a.id),onPaginationChange:K,onSelectChange:W,onSort:$,onCheckBoxChange:G,onIndeterminateCheckBoxChange:M}),e.jsx(R,{isOpen:s,type:"danger",title:"Remove products",onClose:i,onRequestClose:i,onCancel:i,onConfirm:o,children:e.jsxs("p",{children:[" ","Are you sure you want to remove this product? This action can't be undo."," "]})})]})},Ee=()=>{const{selectedProduct:t,productList:s,mutate:n,productListTotal:d,setSelectAllProduct:c}=C(),[i,u]=j.useState(!1),m=()=>{u(!0)},o=()=>{u(!1)},l=()=>{const x=s.filter(h=>!t.some(g=>g.id===h.id));c([]),n({list:x,total:d-t.length},!1),u(!1)};return e.jsxs(e.Fragment,{children:[t.length>0&&e.jsx(de,{className:"flex items-center justify-between py-4 bg-white dark:bg-gray-800",stickyClass:"-mx-4 sm:-mx-8 border-t border-gray-200 dark:border-gray-700 px-8",defaultClass:"container mx-auto px-8 rounded-xl border border-gray-200 dark:border-gray-600 mt-4",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:t.length>0&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg text-primary",children:e.jsx(ne,{})}),e.jsxs("span",{className:"font-semibold flex items-center gap-1",children:[e.jsxs("span",{className:"heading-text",children:[t.length," ","Planos"]}),e.jsx("span",{children:"Buscar"})]})]})}),e.jsx("div",{className:"flex items-center",children:e.jsx(b,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error",onClick:m,children:"Delete"})})]})})}),e.jsx(R,{isOpen:i,type:"danger",title:"Remove products",onClose:o,onRequestClose:o,onCancel:o,onConfirm:l,children:e.jsxs("p",{children:[" ","Are you sure you want to remove these products? This action can't be undo."," "]})})]})},ht=()=>e.jsxs(e.Fragment,{children:[e.jsx(H,{children:e.jsx(J,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Planos"}),e.jsx(Pe,{})]}),e.jsx(Ie,{}),e.jsx(ze,{})]})})}),e.jsx(Ee,{})]});export{ht as default};
