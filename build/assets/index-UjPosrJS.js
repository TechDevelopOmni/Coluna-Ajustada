import{T as y,B as H,r as f,j as e,M as v,d as V,N as E,i as O,U as B}from"./index-C607L3NO.js";import{C as j}from"./Card-1HCxGsWA.js";import{T as A}from"./index-C1K2VtEp.js";import{B as x}from"./Button-BGNlWC2q.js";import{T as Y,a as U}from"./index-Dw6USHNV.js";import{t as R,N as L}from"./toast-CDPb8hdy.js";import{C as G}from"./ConfirmDialog-DSnV0zd4.js";import{d as $,e as K}from"./CloseButton-BXcBQvwe.js";import{T as F}from"./index-xBh2-DTE.js";import{B as J}from"./Badge-BxvBSlDX.js";import{T as W}from"./Tag-BbGzO40G.js";import{i as _}from"./isLastChild-BgvHfb_g.js";import{C as q}from"./CreditCardDialog-BBxcyqUh.js";import{c as X,u as Q,g as Z,a as ee,f as se}from"./index-BJphkZ0V.js";import{N as te}from"./react-number-format.es-DctIRRPE.js";import{c as ae}from"./countries.constant-ZY8wRTuX.js";import{b as le,c as re}from"./CustomersService-ht75Gneg.js";import{s as ie}from"./sleep-BvINh1mj.js";import{az as ne,aA as oe,aB as ce,aC as de,aD as me}from"./index-DQXJF41S.js";import{u as z}from"./index-XbpPjDmP.js";import"./useControllableState-Z-3G6vqG.js";import"./classNames-BXHP0mo8.js";import"./useMergeRef-DOQ7ycPl.js";import"./index-C0Bidem1.js";import"./useTimeout-5mLzQ-yb.js";import"./StatusIcon-CIHdvxDX.js";import"./Dialog-B2uIaC1M.js";import"./index-Bx_zRB3i.js";import"./index-BsyKxmTm.js";import"./isNil-C1sdKuru.js";function xe(s){return y({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M80 299.3V512H196V299.3h86.5l18-97.8H196V166.9c0-51.7 20.3-71.5 72.7-71.5c16.3 0 29.4 .4 37 1.2V7.9C291.4 4 256.4 0 236.2 0C129.3 0 80 50.5 80 159.4v42.1H14v97.8H80z"},child:[]}]})(s)}function he(s){return y({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"},child:[]}]})(s)}function pe(s){return y({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M204 6.5C101.4 6.5 0 74.9 0 185.6 0 256 39.6 296 63.6 296c9.9 0 15.6-27.6 15.6-35.4 0-9.3-23.7-29.1-23.7-67.8 0-80.4 61.2-137.4 140.4-137.4 68.1 0 118.5 38.7 118.5 109.8 0 53.1-21.3 152.7-90.3 152.7-24.9 0-46.2-18-46.2-43.8 0-37.8 26.4-74.4 26.4-113.4 0-66.2-93.9-54.2-93.9 25.8 0 16.8 2.1 35.4 9.6 50.7-13.8 59.4-42 147.9-42 209.1 0 18.9 2.7 37.5 4.5 56.4 3.4 3.8 1.7 3.4 6.9 1.5 50.4-69 48.6-82.5 71.4-172.8 12.3 23.4 44.1 36 69.3 36 106.2 0 153.9-103.5 153.9-196.8C384 71.3 298.2 6.5 204 6.5z"},child:[]}]})(s)}function ue(s){return y({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"},child:[]}]})(s)}const N=({title:s,value:t})=>e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:s}),e.jsx("p",{className:"heading-text font-bold",children:t})]}),fe=({data:s={}})=>{var i,h;const t=H(),[r,n]=f.useState(!1),o=(l="")=>{window.open(`https://${l}`,"_blank","rel=noopener noreferrer")},m=()=>{n(!1)},p=()=>{n(!0)},g=()=>{n(!1),t("/concepts/customers/customer-list"),R.push(e.jsx(L,{title:"Successfully Deleted",type:"success",children:"Customer successfuly deleted"}))},u=()=>{t("/concepts/chat")},c=()=>{t(`/concepts/customers/customer-edit/${s.id}`)};return e.jsxs(j,{className:"w-full",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(Y,{title:"Edit customer",children:e.jsx("button",{className:"close-button button-press-feedback",type:"button",onClick:c,children:e.jsx($,{})})})}),e.jsxs("div",{className:"flex flex-col xl:justify-between h-full 2xl:min-w-[360px] mx-auto",children:[e.jsxs("div",{className:"flex xl:flex-col items-center gap-4 mt-6",children:[e.jsx(U,{size:90,shape:"circle",src:s.img}),e.jsx("h4",{className:"font-bold",children:s.name})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-y-7 gap-x-4 mt-10",children:[e.jsx(N,{title:"Email",value:s.email}),e.jsx(N,{title:"Phone",value:(i=s.personalInfo)==null?void 0:i.phoneNumber}),e.jsx(N,{title:"Date of birth",value:(h=s.personalInfo)==null?void 0:h.birthday}),e.jsx(N,{title:"Last Online",value:v.unix(s.lastOnline).format("DD MMM YYYY hh:mm A")}),e.jsxs("div",{className:"mb-7",children:[e.jsx("span",{children:"Social"}),e.jsxs("div",{className:"flex mt-4 gap-2",children:[e.jsx(x,{size:"sm",icon:e.jsx(xe,{className:"text-[#2259f2]"}),onClick:()=>{var l;return o((l=s.personalInfo)==null?void 0:l.facebook)}}),e.jsx(x,{size:"sm",icon:e.jsx(ue,{className:"text-black dark:text-white"}),onClick:()=>{var l;return o((l=s.personalInfo)==null?void 0:l.twitter)}}),e.jsx(x,{size:"sm",icon:e.jsx(he,{className:"text-[#155fb8]"}),onClick:()=>{var l;return o((l=s.personalInfo)==null?void 0:l.linkedIn)}}),e.jsx(x,{size:"sm",icon:e.jsx(pe,{className:"text-[#df0018]"}),onClick:()=>{var l;return o((l=s.personalInfo)==null?void 0:l.pinterest)}})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(x,{block:!0,variant:"solid",onClick:u,children:"Send Messsage"}),e.jsx(x,{block:!0,customColorClass:()=>"text-error hover:border-error hover:ring-1 ring-error hover:text-error",icon:e.jsx(K,{}),onClick:p,children:"Delete"})]}),e.jsx(G,{isOpen:r,type:"danger",title:"Delete customer",onClose:m,onRequestClose:m,onCancel:m,onConfirm:g,children:e.jsx("p",{children:"Are you sure you want to delete this customer? All record related to this customer will be deleted as well. This action cannot be undone."})})]})]})},{Tr:je,Td:ge,TBody:Ne}=F,be=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ve={paid:"bg-emerald-500",pending:"bg-amber-400"},b=X(),ye=[b.accessor("item",{header:"Product",cell:s=>{const t=s.row.original;return e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-semibold",children:t.item})})}}),b.accessor("status",{header:"Status",cell:s=>{const t=s.row.original;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:ve[t.status]}),e.jsx("span",{className:"heading-text font-bold capitalize",children:t.status})]})}}),b.accessor("date",{header:"Date",cell:s=>{const t=s.row.original;return e.jsx("div",{className:"flex items-center",children:v.unix(t.date).format("MM/DD/YYYY")})}}),b.accessor("amount",{header:"Amount",cell:s=>{const t=s.row.original;return e.jsx("div",{className:"flex items-center",children:e.jsx(te,{displayType:"text",value:(Math.round(t.amount*100)/100).toFixed(2),prefix:"$",thousandSeparator:!0})})}})],C={cardHolderName:"",ccNumber:"",cardExpiry:"",code:""},Ce=({data:s})=>{var i,h,l,T,w,M,D,S;const[t,r]=f.useState(C),[n,o]=f.useState(!1),m=Q({data:s.orderHistory||[],columns:ye,getCoreRowModel:Z(),getSortedRowModel:ee()}),p=f.useMemo(()=>{var a;return(a=ae.find(d=>{var P;return d.value===((P=s.personalInfo)==null?void 0:P.country)}))==null?void 0:a.label},[(i=s.personalInfo)==null?void 0:i.country]),g=(a,d)=>{r({...C,cardHolderName:a,cardExpiry:d}),o(!0)},u=()=>{r(C),o(!1)},c=()=>{u(),R.push(e.jsx(L,{title:"Successfully updated!",type:"success"}),{placement:"top-center"})};return e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:"mb-4",children:"Purchase history"}),e.jsx(F,{children:e.jsx(Ne,{children:m.getRowModel().rows.slice(0,10).map(a=>e.jsx(je,{children:a.getVisibleCells().map(d=>e.jsx(ge,{children:se(d.column.columnDef.cell,d.getContext())},d.id))},a.id))})}),e.jsx("h6",{className:"mt-8",children:"Addresses"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4",children:[e.jsxs(j,{children:[e.jsx("div",{className:"font-bold heading-text",children:"Billing Address"}),e.jsxs("div",{className:"mt-4 flex flex-col gap-1 font-semibold",children:[e.jsx("span",{children:(h=s.personalInfo)==null?void 0:h.address}),e.jsx("span",{children:(l=s.personalInfo)==null?void 0:l.city}),e.jsx("span",{children:(T=s.personalInfo)==null?void 0:T.postcode}),e.jsx("span",{children:p})]})]}),e.jsxs(j,{children:[e.jsx("div",{className:"font-bold heading-text",children:"Delivery Address"}),e.jsxs("div",{className:"mt-4 flex flex-col gap-1 font-semibold",children:[e.jsx("span",{children:(w=s.personalInfo)==null?void 0:w.address}),e.jsx("span",{children:(M=s.personalInfo)==null?void 0:M.city}),e.jsx("span",{children:(D=s.personalInfo)==null?void 0:D.postcode}),e.jsx("span",{children:p})]})]})]}),e.jsx("h6",{className:"mt-8",children:"Payment Methods"}),e.jsxs(j,{className:"mt-4",bodyClass:"py-0",children:[(S=s.paymentMethod)==null?void 0:S.map((a,d)=>e.jsxs("div",{className:V("flex flex-col lg:flex-row lg:items-center justify-between gap-3 p-4",!_(s.paymentMethod||[],d)&&"border-b border-gray-200 dark:border-gray-600"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a.cardType==="VISA"&&e.jsx("img",{src:"/img/others/img-8.png",alt:"visa"}),a.cardType==="MASTER"&&e.jsx("img",{src:"/img/others/img-9.png",alt:"master"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"text-gray-900 dark:text-gray-100 font-semibold",children:[a.cardHolderName," ••••"," ",a.last4Number]}),a.primary&&e.jsx(W,{className:"bg-sky-100 text-primary dark:bg-primary/20 dark:text-primary rounded-md border-0 mx-2",children:e.jsxs("span",{className:"capitalize",children:[" ","Primary"," "]})})]}),e.jsxs("span",{children:["Expired"," ",be[parseInt(a.expMonth)-1]," 20",a.expYear]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{size:"sm",onClick:()=>g(a.cardHolderName,`${a.expMonth}${a.expYear}`),children:"Edit"})})]},a.last4Number)),e.jsx(q,{title:"Edit credit card",defaultValues:t,dialogOpen:n,onDialogClose:u,onSubmit:c})]})]})},Te=s=>{const{type:t}=s;switch(t){case"PRODUCT-VIEW":return e.jsx(me,{});case"PRODUCT-UPDATE":return e.jsx(de,{});case"PAYMENT":return e.jsx(ce,{});case"SUPPORT-TICKET":return e.jsx(oe,{});case"TICKET-IN-PROGRESS":return e.jsx(ne,{});default:return e.jsx(e.Fragment,{})}},we=s=>{const{type:t,description:r,name:n}=s;switch(t){case"PRODUCT-VIEW":return e.jsxs("div",{children:[e.jsx("h6",{className:"font-bold",children:"View Plan"}),e.jsxs("p",{className:"font-semibold",children:[n," ",r]})]});case"PRODUCT-UPDATE":return e.jsxs("div",{children:[e.jsx("h6",{className:"font-bold",children:"Change Plan"}),e.jsxs("p",{className:"font-semibold",children:[n," ",r]})]});case"PAYMENT":return e.jsxs("div",{children:[e.jsx("h6",{className:"font-bold",children:"Payment"}),e.jsxs("p",{className:"font-semibold",children:[n," ",r]})]});case"SUPPORT-TICKET":return e.jsxs("div",{children:[e.jsx("h6",{className:"font-bold",children:"Support Ticket"}),e.jsxs("p",{className:"font-semibold",children:[n," ",r]})]});case"TICKET-IN-PROGRESS":return e.jsxs("div",{children:[e.jsx("h6",{className:"font-bold",children:"Support Ticket Update"}),e.jsx("p",{className:"font-semibold",children:r})]});default:return e.jsx(e.Fragment,{})}},Me=({customerName:s,id:t})=>{const{data:r,isLoading:n}=z(["/api/customers/log",{id:t}],([c,i])=>le(i),{revalidateOnFocus:!1,revalidateIfStale:!1,evalidateOnFocus:!1}),[o,m]=f.useState(!1),[p,g]=f.useState(!1),u=async()=>{m(!0),await ie(500),g(!0),m(!1)};return e.jsxs(E,{loading:n,children:[r&&r.map(c=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"mb-4 font-bold uppercase flex items-center gap-4",children:[e.jsx("span",{className:"w-[70px] heading-text",children:v.unix(c.date).format("DD MMMM")}),e.jsx("div",{className:"border-b border-2 border-gray-200 dark:border-gray-600 border-dashed w-full"})]}),e.jsx("div",{className:"flex flex-col gap-4",children:O(c.events)?e.jsx("div",{children:"No Activities"}):c.events.map((i,h)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-semibold w-[100px]",children:v.unix(i.dateTime).format("h:mm A")}),e.jsx(j,{className:"max-w-[600px] w-full",bodyClass:"py-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-primary text-3xl",children:e.jsx(Te,{type:i.type})}),e.jsx(we,{name:s,type:i.type,description:i==null?void 0:i.description})]})})]},i.type+h))})]},c.id)),e.jsx("div",{className:"text-center",children:p?e.jsx("span",{className:"font-semibold h-[40px] flex items-center justify-center",children:"No more activities"}):e.jsx(x,{loading:o,onClick:u,children:"Load More"})})]})},{TabNav:I,TabList:De,TabContent:k}=A,ls=()=>{const{id:s}=B(),{data:t,isLoading:r}=z(["/api/customers",{id:s}],([n,o])=>re(o),{revalidateOnFocus:!1,revalidateIfStale:!1,evalidateOnFocus:!1});return e.jsx(E,{loading:r,children:!O(t)&&e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4",children:[e.jsx("div",{className:"min-w-[330px] 2xl:min-w-[400px]",children:e.jsx(fe,{data:t})}),e.jsx(j,{className:"w-full",children:e.jsxs(A,{defaultValue:"billing",children:[e.jsxs(De,{children:[e.jsx(I,{value:"billing",children:"Billing"}),e.jsx(I,{value:"activity",children:"Activity"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx(k,{value:"billing",children:e.jsx(Ce,{data:t})}),e.jsx(k,{value:"activity",children:e.jsx(Me,{customerName:t.name,id:s})})]})]})})]})})};export{ls as default};
